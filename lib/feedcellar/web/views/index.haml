%h1 feedcellar-web
%p= "Powered by Groonga #{groonga_version} and Rroonga #{rroonga_version}."
%form{:action => url("/search", false, true), :method => :get}
  %input{:type => "textarea", :name => "word", :size => 20, :value => params[:word]}
  %input{:type => "submit", :value => "Search"}
- if @feeds
  %p
    - grouping(@feeds).each do |resource|
      = link_to(drilled_label(resource), drilled_url(resource))
  = paginate(@paginated_feeds)
  %ul
    - @paginated_feeds.each do |feed|
      %li
        %p
          = link_to("#{feed.title} - #{feed.resource.title}", feed.link)
  = paginate(@paginated_feeds)
  %p
    - @feeds.group("year").each do |group|
      - year = group.key
      = link_to("#{"%04d" % year} (#{group.n_sub_records})",
                url("/search?word=#{params[:word]}&year=#{year}"))
  %p
    - @feeds.group(["year", "month"]).each do |group|
      - sub_record = group.sub_records.first
      - year = sub_record.year
      - month = sub_record.month
      = link_to("#{"%04d" % year}-#{"%02d" % month} (#{group.n_sub_records})",
                url("/search?word=#{params[:word]}&year=#{year}&month=#{month}"))
  %p
    - @feeds.group("month").sort_by {|record| record.key}.each do |group|
      - month = group.key
      - if month == 0
        - next
      = link_to("#{month} (#{group.n_sub_records})",
                url("/search?word=#{params[:word]}&month=#{month}"))
